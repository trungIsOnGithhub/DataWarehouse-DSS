2023-12-13 13:10:38,009  |  INFO  |    
2023-12-13 13:10:38,010  |  INFO  |  ---------------------------------------------  
2023-12-13 13:10:38,010  |  INFO  |  Beginning the source data extraction process...  
2023-12-13 13:10:38,010  |  INFO  |  Successfully located 'sales_agents.json'  
2023-12-13 13:10:38,011  |  INFO  |  File type: '<class 'list'>'  
2023-12-13 13:10:38,059  |  DEBUG  |    
2023-12-13 13:10:38,059  |  INFO  |  =================================================================================  
2023-12-13 13:10:38,060  |  INFO  |  CONNECTION SUCCESS: Managed to connect successfully to the dwdss database!!  
2023-12-13 13:10:38,060  |  INFO  |  Connection details: user=postgres password=xxx dbname=dwdss host=localhost port=5432   
2023-12-13 13:10:38,060  |  INFO  |  =================================================================================  
2023-12-13 13:10:38,060  |  DEBUG  |    
2023-12-13 13:10:38,062  |  DEBUG  |    
2023-12-13 13:10:38,062  |  INFO  |  =================================================================================================  
2023-12-13 13:10:38,063  |  INFO  |  SCHEMA CREATION SUCCESS: Managed to create main schema in dwdss   
2023-12-13 13:10:38,063  |  INFO  |  Schema name in Postgres: main   
2023-12-13 13:10:38,063  |  INFO  |  SQL Query for validation check:     SELECT schema_name from information_schema.schemata WHERE schema_name= 'main';
           
2023-12-13 13:10:38,063  |  INFO  |  =================================================================================================  
2023-12-13 13:10:38,063  |  DEBUG  |    
2023-12-13 13:10:38,069  |  DEBUG  |    
2023-12-13 13:10:38,069  |  ERROR  |  ==========================================================================================================================================================================  
2023-12-13 13:10:38,069  |  ERROR  |  TABLE DELETION FAILURE: Unable to delete raw_sales_agents_tbl. This table may have objects that depend on it (use DROP TABLE ... CASCADE to resolve) or it doesn't exist.   
2023-12-13 13:10:38,070  |  ERROR  |  SQL Query for validation check:     SELECT EXISTS (SELECT 1 FROM information_schema.tables WHERE table_name = 'raw_sales_agents_tbl' );
           
2023-12-13 13:10:38,070  |  ERROR  |  ==========================================================================================================================================================================  
2023-12-13 13:10:38,070  |  DEBUG  |    
2023-12-13 13:10:38,074  |  DEBUG  |    
2023-12-13 13:10:38,075  |  INFO  |  =============================================================================================================================================================================  
2023-12-13 13:10:38,075  |  INFO  |  TABLE CREATION SUCCESS: Managed to create raw_sales_agents_tbl table in dwdss.    
2023-12-13 13:10:38,075  |  INFO  |  SQL Query for validation check:         SELECT EXISTS (SELECT 1 FROM information_schema.tables WHERE table_name = 'raw_sales_agents_tbl' );
           
2023-12-13 13:10:38,076  |  INFO  |  =============================================================================================================================================================================  
2023-12-13 13:10:38,076  |  DEBUG  |    
2023-12-13 13:10:38,086  |  DEBUG  |    
2023-12-13 13:10:38,086  |  INFO  |  =============================================================================================================================================================================  
2023-12-13 13:10:38,086  |  INFO  |  DATA LINEAGE FIELDS CREATION SUCCESS: Managed to create data lineage columns in main.raw_sales_agents_tbl.    
2023-12-13 13:10:38,087  |  INFO  |  SQL Query for validation check:          
                                                                    SELECT * 
                                                                    FROM    information_schema.columns 
                                                                    WHERE   table_name      = 'raw_sales_agents_tbl' 
                                                                        AND     (column_name    = 'created_at'
                                                                        OR      column_name     = 'updated_at' 
                                                                        OR      column_name     = 'source_system' 
                                                                        OR      column_name     = 'source_file' 
                                                                        OR      column_name     = 'load_timestamp' 
                                                                        OR      column_name     = 'dwh_layer');
                                                                              
           
2023-12-13 13:10:38,088  |  INFO  |  =============================================================================================================================================================================  
2023-12-13 13:10:38,088  |  DEBUG  |    
2023-12-13 13:10:38,089  |  INFO  |  Rows before SQL insert in Postgres: 0   
2023-12-13 13:10:38,089  |  DEBUG  |    
2023-12-13 13:10:38,090  |  DEBUG  |  ---------------------------------  
2023-12-13 13:10:38,090  |  INFO  |  INSERT SUCCESS: Uploaded sales_agents record no 1   
2023-12-13 13:10:38,090  |  DEBUG  |  ---------------------------------  
2023-12-13 13:10:38,091  |  DEBUG  |  ---------------------------------  
2023-12-13 13:10:38,091  |  INFO  |  INSERT SUCCESS: Uploaded sales_agents record no 2   
2023-12-13 13:10:38,091  |  DEBUG  |  ---------------------------------  
2023-12-13 13:10:38,091  |  DEBUG  |  ---------------------------------  
2023-12-13 13:10:38,092  |  INFO  |  INSERT SUCCESS: Uploaded sales_agents record no 3   
2023-12-13 13:10:38,092  |  DEBUG  |  ---------------------------------  
2023-12-13 13:10:38,093  |  DEBUG  |  ---------------------------------  
2023-12-13 13:10:38,093  |  INFO  |  INSERT SUCCESS: Uploaded sales_agents record no 4   
2023-12-13 13:10:38,093  |  DEBUG  |  ---------------------------------  
2023-12-13 13:10:38,094  |  DEBUG  |  ---------------------------------  
2023-12-13 13:10:38,094  |  INFO  |  INSERT SUCCESS: Uploaded sales_agents record no 5   
2023-12-13 13:10:38,094  |  DEBUG  |  ---------------------------------  
2023-12-13 13:10:38,095  |  DEBUG  |  ---------------------------------  
2023-12-13 13:10:38,095  |  INFO  |  INSERT SUCCESS: Uploaded sales_agents record no 6   
2023-12-13 13:10:38,096  |  DEBUG  |  ---------------------------------  
2023-12-13 13:10:38,096  |  DEBUG  |  ---------------------------------  
2023-12-13 13:10:38,096  |  INFO  |  INSERT SUCCESS: Uploaded sales_agents record no 7   
2023-12-13 13:10:38,096  |  DEBUG  |  ---------------------------------  
2023-12-13 13:10:38,097  |  DEBUG  |  ---------------------------------  
2023-12-13 13:10:38,097  |  INFO  |  INSERT SUCCESS: Uploaded sales_agents record no 8   
2023-12-13 13:10:38,097  |  DEBUG  |  ---------------------------------  
2023-12-13 13:10:38,098  |  DEBUG  |  ---------------------------------  
2023-12-13 13:10:38,098  |  INFO  |  INSERT SUCCESS: Uploaded sales_agents record no 9   
2023-12-13 13:10:38,098  |  DEBUG  |  ---------------------------------  
2023-12-13 13:10:38,098  |  DEBUG  |  ---------------------------------  
2023-12-13 13:10:38,099  |  INFO  |  INSERT SUCCESS: Uploaded sales_agents record no 10   
2023-12-13 13:10:38,099  |  DEBUG  |  ---------------------------------  
2023-12-13 13:10:38,099  |  DEBUG  |  ---------------------------------  
2023-12-13 13:10:38,099  |  INFO  |  INSERT SUCCESS: Uploaded sales_agents record no 11   
2023-12-13 13:10:38,099  |  DEBUG  |  ---------------------------------  
2023-12-13 13:10:38,100  |  DEBUG  |  ---------------------------------  
2023-12-13 13:10:38,100  |  INFO  |  INSERT SUCCESS: Uploaded sales_agents record no 12   
2023-12-13 13:10:38,100  |  DEBUG  |  ---------------------------------  
2023-12-13 13:10:38,101  |  DEBUG  |  ---------------------------------  
2023-12-13 13:10:38,101  |  INFO  |  INSERT SUCCESS: Uploaded sales_agents record no 13   
2023-12-13 13:10:38,101  |  DEBUG  |  ---------------------------------  
2023-12-13 13:10:38,102  |  DEBUG  |  ---------------------------------  
2023-12-13 13:10:38,102  |  INFO  |  INSERT SUCCESS: Uploaded sales_agents record no 14   
2023-12-13 13:10:38,103  |  DEBUG  |  ---------------------------------  
2023-12-13 13:10:38,103  |  DEBUG  |  ---------------------------------  
2023-12-13 13:10:38,103  |  INFO  |  INSERT SUCCESS: Uploaded sales_agents record no 15   
2023-12-13 13:10:38,104  |  DEBUG  |  ---------------------------------  
2023-12-13 13:10:38,104  |  DEBUG  |  ---------------------------------  
2023-12-13 13:10:38,104  |  INFO  |  INSERT SUCCESS: Uploaded sales_agents record no 16   
2023-12-13 13:10:38,104  |  DEBUG  |  ---------------------------------  
2023-12-13 13:10:38,105  |  DEBUG  |  ---------------------------------  
2023-12-13 13:10:38,105  |  INFO  |  INSERT SUCCESS: Uploaded sales_agents record no 17   
2023-12-13 13:10:38,105  |  DEBUG  |  ---------------------------------  
2023-12-13 13:10:38,105  |  DEBUG  |  ---------------------------------  
2023-12-13 13:10:38,105  |  INFO  |  INSERT SUCCESS: Uploaded sales_agents record no 18   
2023-12-13 13:10:38,105  |  DEBUG  |  ---------------------------------  
2023-12-13 13:10:38,105  |  DEBUG  |  ---------------------------------  
2023-12-13 13:10:38,105  |  INFO  |  INSERT SUCCESS: Uploaded sales_agents record no 19   
2023-12-13 13:10:38,105  |  DEBUG  |  ---------------------------------  
2023-12-13 13:10:38,106  |  DEBUG  |  ---------------------------------  
2023-12-13 13:10:38,106  |  INFO  |  INSERT SUCCESS: Uploaded sales_agents record no 20   
2023-12-13 13:10:38,106  |  DEBUG  |  ---------------------------------  
2023-12-13 13:10:38,107  |  DEBUG  |  ---------------------------------  
2023-12-13 13:10:38,107  |  INFO  |  INSERT SUCCESS: Uploaded sales_agents record no 21   
2023-12-13 13:10:38,107  |  DEBUG  |  ---------------------------------  
2023-12-13 13:10:38,107  |  DEBUG  |  ---------------------------------  
2023-12-13 13:10:38,108  |  INFO  |  INSERT SUCCESS: Uploaded sales_agents record no 22   
2023-12-13 13:10:38,108  |  DEBUG  |  ---------------------------------  
2023-12-13 13:10:38,109  |  DEBUG  |  ---------------------------------  
2023-12-13 13:10:38,109  |  INFO  |  INSERT SUCCESS: Uploaded sales_agents record no 23   
2023-12-13 13:10:38,109  |  DEBUG  |  ---------------------------------  
2023-12-13 13:10:38,110  |  DEBUG  |  ---------------------------------  
2023-12-13 13:10:38,110  |  INFO  |  INSERT SUCCESS: Uploaded sales_agents record no 24   
2023-12-13 13:10:38,110  |  DEBUG  |  ---------------------------------  
2023-12-13 13:10:38,111  |  DEBUG  |  ---------------------------------  
2023-12-13 13:10:38,111  |  INFO  |  INSERT SUCCESS: Uploaded sales_agents record no 25   
2023-12-13 13:10:38,111  |  DEBUG  |  ---------------------------------  
2023-12-13 13:10:38,112  |  DEBUG  |  ---------------------------------  
2023-12-13 13:10:38,112  |  INFO  |  INSERT SUCCESS: Uploaded sales_agents record no 26   
2023-12-13 13:10:38,112  |  DEBUG  |  ---------------------------------  
2023-12-13 13:10:38,113  |  DEBUG  |  ---------------------------------  
2023-12-13 13:10:38,113  |  INFO  |  INSERT SUCCESS: Uploaded sales_agents record no 27   
2023-12-13 13:10:38,113  |  DEBUG  |  ---------------------------------  
2023-12-13 13:10:38,113  |  DEBUG  |  ---------------------------------  
2023-12-13 13:10:38,114  |  INFO  |  INSERT SUCCESS: Uploaded sales_agents record no 28   
2023-12-13 13:10:38,114  |  DEBUG  |  ---------------------------------  
2023-12-13 13:10:38,114  |  DEBUG  |  ---------------------------------  
2023-12-13 13:10:38,114  |  INFO  |  INSERT SUCCESS: Uploaded sales_agents record no 29   
2023-12-13 13:10:38,114  |  DEBUG  |  ---------------------------------  
2023-12-13 13:10:38,115  |  DEBUG  |  ---------------------------------  
2023-12-13 13:10:38,115  |  INFO  |  INSERT SUCCESS: Uploaded sales_agents record no 30   
2023-12-13 13:10:38,115  |  DEBUG  |  ---------------------------------  
2023-12-13 13:10:38,115  |  INFO  |  Rows after SQL insert in Postgres: 30   
2023-12-13 13:10:38,116  |  DEBUG  |    
2023-12-13 13:10:38,116  |  WARNING  |  Here are the columns considered sensitive in this table ...  
2023-12-13 13:10:38,116  |  WARNING  |    
2023-12-13 13:10:38,116  |  WARNING  |  1 : 'id'    
2023-12-13 13:10:38,116  |  WARNING  |  2 : 'first_name'    
2023-12-13 13:10:38,117  |  WARNING  |  3 : 'last_name'    
2023-12-13 13:10:38,117  |  WARNING  |  4 : 'email'    
2023-12-13 13:10:38,117  |  WARNING  |  5 : 'phone'    
2023-12-13 13:10:38,117  |  WARNING  |  6 : 'location'    
2023-12-13 13:10:38,118  |  WARNING  |  7 : 'nationality'    
2023-12-13 13:10:38,118  |  WARNING  |  8 : 'seniority_level'    
2023-12-13 13:10:38,118  |  WARNING  |  9 : 'service_speciality'    
2023-12-13 13:10:38,118  |  WARNING  |  10 : 'commission'    
2023-12-13 13:10:38,119  |  WARNING  |  11 : 'years_experience'    
2023-12-13 13:10:38,119  |  WARNING  |    
2023-12-13 13:10:38,119  |  WARNING  |    
2023-12-13 13:10:38,119  |  WARNING  |  Decide on the appropriate treatment for these tables. A few options to consider include:  
2023-12-13 13:10:38,119  |  WARNING  |  1. Masking fields               -   This involves replacing sensitive columns with alternative characters e.g.  'xxxx-xxxx', '*****', '$$$$'.   
2023-12-13 13:10:38,119  |  WARNING  |  2. Encrypting fields            -   This is converting sensitive columns to cipher text (unreadable text format).          
2023-12-13 13:10:38,120  |  WARNING  |  3. Role-based access control    -   Placing a system that delegates privileges based on team members' responsibilities          
2023-12-13 13:10:38,120  |  WARNING  |    
2023-12-13 13:10:38,120  |  WARNING  |  Now terminating the sensitive column identification stage ...  
2023-12-13 13:10:38,120  |  WARNING  |  Sensitive column identification stage ended.   
2023-12-13 13:10:38,121  |  WARNING  |    
2023-12-13 13:10:38,121  |  WARNING  |    
2023-12-13 13:10:38,121  |  WARNING  |    
2023-12-13 13:10:38,127  |  INFO  |  ================================================  
2023-12-13 13:10:38,128  |  INFO  |    
2023-12-13 13:10:38,128  |  INFO  |  Now calculating performance statistics (from a Python standpoint)...  
2023-12-13 13:10:38,128  |  INFO  |    
2023-12-13 13:10:38,128  |  INFO  |    
2023-12-13 13:10:38,129  |  DEBUG  |    
2023-12-13 13:10:38,129  |  INFO  |  DATA VALIDATION SUCCESS: All general DQ checks passed!   
2023-12-13 13:10:38,129  |  DEBUG  |    
2023-12-13 13:10:38,129  |  INFO  |  Now saving changes made by SQL statements to Postgres DB....  
2023-12-13 13:10:38,129  |  INFO  |  Saved successfully, now terminating cursor and current session....  
2023-12-13 13:10:38,130  |  DEBUG  |    
2023-12-13 13:10:38,130  |  DEBUG  |  Cursor closed successfully.  
2023-12-13 13:10:38,130  |  DEBUG  |  Session connected to Postgres database closed.  
