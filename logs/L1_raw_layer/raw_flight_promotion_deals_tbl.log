2023-12-13 13:10:37,245  |  INFO  |    
2023-12-13 13:10:37,245  |  INFO  |  ---------------------------------------------  
2023-12-13 13:10:37,245  |  INFO  |  Beginning the source data extraction process...  
2023-12-13 13:10:37,246  |  INFO  |  Successfully located 'flight_promotion_deals.json'  
2023-12-13 13:10:37,247  |  INFO  |  File type: '<class 'list'>'  
2023-12-13 13:10:37,294  |  DEBUG  |    
2023-12-13 13:10:37,295  |  INFO  |  =================================================================================  
2023-12-13 13:10:37,295  |  INFO  |  CONNECTION SUCCESS: Managed to connect successfully to the dwdss database!!  
2023-12-13 13:10:37,295  |  INFO  |  Connection details: user=postgres password=xxx dbname=dwdss host=localhost port=5432   
2023-12-13 13:10:37,296  |  INFO  |  =================================================================================  
2023-12-13 13:10:37,296  |  DEBUG  |    
2023-12-13 13:10:37,298  |  DEBUG  |    
2023-12-13 13:10:37,298  |  INFO  |  =================================================================================================  
2023-12-13 13:10:37,298  |  INFO  |  SCHEMA CREATION SUCCESS: Managed to create main schema in dwdss   
2023-12-13 13:10:37,299  |  INFO  |  Schema name in Postgres: main   
2023-12-13 13:10:37,299  |  INFO  |  SQL Query for validation check:     SELECT schema_name from information_schema.schemata WHERE schema_name= 'main';
           
2023-12-13 13:10:37,299  |  INFO  |  =================================================================================================  
2023-12-13 13:10:37,299  |  DEBUG  |    
2023-12-13 13:10:37,304  |  DEBUG  |    
2023-12-13 13:10:37,305  |  ERROR  |  ==========================================================================================================================================================================  
2023-12-13 13:10:37,305  |  ERROR  |  TABLE DELETION FAILURE: Unable to delete raw_flight_promotion_deals_tbl. This table may have objects that depend on it (use DROP TABLE ... CASCADE to resolve) or it doesn't exist.   
2023-12-13 13:10:37,305  |  ERROR  |  SQL Query for validation check:     SELECT EXISTS (SELECT 1 FROM information_schema.tables WHERE table_name = 'raw_flight_promotion_deals_tbl' );
           
2023-12-13 13:10:37,306  |  ERROR  |  ==========================================================================================================================================================================  
2023-12-13 13:10:37,306  |  DEBUG  |    
2023-12-13 13:10:37,311  |  DEBUG  |    
2023-12-13 13:10:37,311  |  INFO  |  =============================================================================================================================================================================  
2023-12-13 13:10:37,312  |  INFO  |  TABLE CREATION SUCCESS: Managed to create raw_flight_promotion_deals_tbl table in dwdss.    
2023-12-13 13:10:37,312  |  INFO  |  SQL Query for validation check:         SELECT EXISTS (SELECT 1 FROM information_schema.tables WHERE table_name = 'raw_flight_promotion_deals_tbl' );
           
2023-12-13 13:10:37,313  |  INFO  |  =============================================================================================================================================================================  
2023-12-13 13:10:37,313  |  DEBUG  |    
2023-12-13 13:10:37,323  |  DEBUG  |    
2023-12-13 13:10:37,323  |  INFO  |  =============================================================================================================================================================================  
2023-12-13 13:10:37,323  |  INFO  |  DATA LINEAGE FIELDS CREATION SUCCESS: Managed to create data lineage columns in main.raw_flight_promotion_deals_tbl.    
2023-12-13 13:10:37,323  |  INFO  |  SQL Query for validation check:          
                                                                    SELECT * 
                                                                    FROM    information_schema.columns 
                                                                    WHERE   table_name      = 'raw_flight_promotion_deals_tbl' 
                                                                        AND     (column_name    = 'created_at'
                                                                        OR      column_name     = 'updated_at' 
                                                                        OR      column_name     = 'source_system' 
                                                                        OR      column_name     = 'source_file' 
                                                                        OR      column_name     = 'load_timestamp' 
                                                                        OR      column_name     = 'dwh_layer');
                                                                              
           
2023-12-13 13:10:37,325  |  INFO  |  =============================================================================================================================================================================  
2023-12-13 13:10:37,325  |  DEBUG  |    
2023-12-13 13:10:37,326  |  INFO  |  Rows before SQL insert in Postgres: 0   
2023-12-13 13:10:37,326  |  DEBUG  |    
2023-12-13 13:10:37,327  |  DEBUG  |  ---------------------------------  
2023-12-13 13:10:37,329  |  INFO  |  INSERT SUCCESS: Uploaded flight_promotion_deals record no 1   
2023-12-13 13:10:37,329  |  DEBUG  |  ---------------------------------  
2023-12-13 13:10:37,329  |  DEBUG  |  ---------------------------------  
2023-12-13 13:10:37,329  |  INFO  |  INSERT SUCCESS: Uploaded flight_promotion_deals record no 2   
2023-12-13 13:10:37,329  |  DEBUG  |  ---------------------------------  
2023-12-13 13:10:37,330  |  DEBUG  |  ---------------------------------  
2023-12-13 13:10:37,330  |  INFO  |  INSERT SUCCESS: Uploaded flight_promotion_deals record no 3   
2023-12-13 13:10:37,330  |  DEBUG  |  ---------------------------------  
2023-12-13 13:10:37,330  |  DEBUG  |  ---------------------------------  
2023-12-13 13:10:37,331  |  INFO  |  INSERT SUCCESS: Uploaded flight_promotion_deals record no 4   
2023-12-13 13:10:37,331  |  DEBUG  |  ---------------------------------  
2023-12-13 13:10:37,331  |  DEBUG  |  ---------------------------------  
2023-12-13 13:10:37,331  |  INFO  |  INSERT SUCCESS: Uploaded flight_promotion_deals record no 5   
2023-12-13 13:10:37,332  |  DEBUG  |  ---------------------------------  
2023-12-13 13:10:37,332  |  DEBUG  |  ---------------------------------  
2023-12-13 13:10:37,332  |  INFO  |  INSERT SUCCESS: Uploaded flight_promotion_deals record no 6   
2023-12-13 13:10:37,333  |  DEBUG  |  ---------------------------------  
2023-12-13 13:10:37,333  |  DEBUG  |  ---------------------------------  
2023-12-13 13:10:37,333  |  INFO  |  INSERT SUCCESS: Uploaded flight_promotion_deals record no 7   
2023-12-13 13:10:37,334  |  DEBUG  |  ---------------------------------  
2023-12-13 13:10:37,334  |  DEBUG  |  ---------------------------------  
2023-12-13 13:10:37,335  |  INFO  |  INSERT SUCCESS: Uploaded flight_promotion_deals record no 8   
2023-12-13 13:10:37,335  |  DEBUG  |  ---------------------------------  
2023-12-13 13:10:37,336  |  DEBUG  |  ---------------------------------  
2023-12-13 13:10:37,336  |  INFO  |  INSERT SUCCESS: Uploaded flight_promotion_deals record no 9   
2023-12-13 13:10:37,336  |  DEBUG  |  ---------------------------------  
2023-12-13 13:10:37,337  |  DEBUG  |  ---------------------------------  
2023-12-13 13:10:37,337  |  INFO  |  INSERT SUCCESS: Uploaded flight_promotion_deals record no 10   
2023-12-13 13:10:37,337  |  DEBUG  |  ---------------------------------  
2023-12-13 13:10:37,338  |  INFO  |  Rows after SQL insert in Postgres: 10   
2023-12-13 13:10:37,338  |  DEBUG  |    
2023-12-13 13:10:37,338  |  ERROR  |  There are no sensitive columns for the 'raw_flight_promotion_deals_tbl' table   
2023-12-13 13:10:37,338  |  WARNING  |    
2023-12-13 13:10:37,338  |  WARNING  |  1 : 'None'    
2023-12-13 13:10:37,338  |  WARNING  |    
2023-12-13 13:10:37,338  |  WARNING  |  Now terminating the sensitive column identification stage ...  
2023-12-13 13:10:37,339  |  WARNING  |  Sensitive column identification stage ended.   
2023-12-13 13:10:37,339  |  WARNING  |    
2023-12-13 13:10:37,339  |  WARNING  |    
2023-12-13 13:10:37,339  |  WARNING  |    
2023-12-13 13:10:37,346  |  INFO  |  ================================================  
2023-12-13 13:10:37,346  |  INFO  |    
2023-12-13 13:10:37,346  |  INFO  |  Now calculating performance statistics (from a Python standpoint)...  
2023-12-13 13:10:37,346  |  INFO  |    
2023-12-13 13:10:37,347  |  INFO  |    
2023-12-13 13:10:37,347  |  DEBUG  |    
2023-12-13 13:10:37,347  |  INFO  |  DATA VALIDATION SUCCESS: All general DQ checks passed!   
2023-12-13 13:10:37,348  |  DEBUG  |    
2023-12-13 13:10:37,348  |  INFO  |  Now saving changes made by SQL statements to Postgres DB....  
2023-12-13 13:10:37,348  |  INFO  |  Saved successfully, now terminating cursor and current session....  
2023-12-13 13:10:37,348  |  DEBUG  |    
2023-12-13 13:10:37,348  |  DEBUG  |  Cursor closed successfully.  
2023-12-13 13:10:37,349  |  DEBUG  |  Session connected to Postgres database closed.  
