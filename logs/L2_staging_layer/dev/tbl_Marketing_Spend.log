2023-12-15 20:49:12,184  |  INFO  |    
2023-12-15 20:49:12,185  |  INFO  |  ---------------------------------------------  
2023-12-15 20:49:12,185  |  INFO  |  Beginning the staging process...  
2023-12-15 20:49:12,231  |  DEBUG  |    
2023-12-15 20:49:12,232  |  INFO  |  =================================================================================  
2023-12-15 20:49:12,232  |  INFO  |  CONNECTION SUCCESS: Managed to connect successfully to the oltp_db database!!  
2023-12-15 20:49:12,232  |  INFO  |  Connection details: user=postgres password=xxx dbname=oltp_db host=localhost port=5432   
2023-12-15 20:49:12,232  |  INFO  |  =================================================================================  
2023-12-15 20:49:12,233  |  DEBUG  |    
2023-12-15 20:49:12,233  |  DEBUG  |  SELECT dateh, offs, ons FROM oltp_main.marketing_spend;  
              
2023-12-15 20:49:12,233  |  INFO  |    
2023-12-15 20:49:12,233  |  INFO  |  Successfully IMPORTED the 'marketing_spend' virtual table from the 'localhost' server into the 'oltp_main' schema for 'oltp_db' database. Now advancing to data cleaning stage...  
2023-12-15 20:49:12,233  |  INFO  |    
2023-12-15 20:49:12,235  |  INFO  |  cannot access local variable 'temp_df' where it is not associated with a value  
2023-12-15 20:49:12,235  |  DEBUG  |    
2023-12-15 20:49:12,235  |  DEBUG  |  Cursor closed successfully.  
2023-12-15 20:49:12,235  |  DEBUG  |  Session connected to Postgres database closed.  
2023-12-15 20:49:12,237  |  INFO  |    
2023-12-15 20:49:12,238  |  INFO  |  ---------------------------------------------  
2023-12-15 20:49:12,239  |  INFO  |  Beginning the source data extraction process...  
2023-12-15 20:49:12,240  |  INFO  |  Successfully located 'Marketing_Spend.sql.json'  
2023-12-15 20:49:12,240  |  INFO  |  File type: '<class 'list'>'  
2023-12-15 20:49:12,377  |  DEBUG  |    
2023-12-15 20:49:12,377  |  INFO  |  =================================================================================  
2023-12-15 20:49:12,378  |  INFO  |  CONNECTION SUCCESS: Managed to connect successfully to the initial_dw database!!  
2023-12-15 20:49:12,378  |  INFO  |  Connection details: user=postgres password=xxx dbname=initial_dw host=localhost port=5432   
2023-12-15 20:49:12,379  |  INFO  |  =================================================================================  
2023-12-15 20:49:12,379  |  DEBUG  |    
2023-12-15 20:49:12,382  |  DEBUG  |    
2023-12-15 20:49:12,383  |  INFO  |  =================================================================================================  
2023-12-15 20:49:12,383  |  INFO  |  SCHEMA CREATION SUCCESS: Managed to create main schema in initial_dw   
2023-12-15 20:49:12,383  |  INFO  |  Schema name in Postgres: main   
2023-12-15 20:49:12,384  |  INFO  |  SQL Query for validation check:  SELECT schema_name from information_schema.schemata WHERE schema_name= 'main';   
2023-12-15 20:49:12,384  |  INFO  |  =================================================================================================  
2023-12-15 20:49:12,385  |  DEBUG  |    
2023-12-15 20:49:12,391  |  DEBUG  |    
2023-12-15 20:49:12,392  |  ERROR  |  ==========================================================================================================================================================================  
2023-12-15 20:49:12,392  |  ERROR  |  TABLE DELETION FAILURE: Unable to delete marketing_spend. This table may have objects that depend on it (use DROP TABLE ... CASCADE to resolve) or it doesn't exist.   
2023-12-15 20:49:12,393  |  ERROR  |  SQL Query for validation check:  SELECT EXISTS (SELECT 1 FROM information_schema.tables WHERE table_name = 'marketing_spend' );   
2023-12-15 20:49:12,393  |  ERROR  |  ==========================================================================================================================================================================  
2023-12-15 20:49:12,394  |  DEBUG  |    
2023-12-15 20:49:12,400  |  DEBUG  |    
2023-12-15 20:49:12,401  |  INFO  |  =============================================================================================================================================================================  
2023-12-15 20:49:12,401  |  INFO  |  TABLE CREATION SUCCESS: Managed to create marketing_spend table in initial_dw.    
2023-12-15 20:49:12,402  |  INFO  |  SQL Query for validation check:  SELECT EXISTS (SELECT 1 FROM information_schema.tables WHERE table_name = 'marketing_spend' );   
2023-12-15 20:49:12,402  |  INFO  |  =============================================================================================================================================================================  
2023-12-15 20:49:12,403  |  DEBUG  |    
2023-12-15 20:49:12,405  |  INFO  |  Rows before SQL insert in Postgres: 0   
2023-12-15 20:49:12,405  |  DEBUG  |    
2023-12-15 20:49:12,407  |  DEBUG  |  ---------------------------------  
2023-12-15 20:49:12,408  |  INFO  |  INSERT SUCCESS record no 1   
2023-12-15 20:49:12,417  |  DEBUG  |  ---------------------------------  
2023-12-15 20:49:12,419  |  DEBUG  |  ---------------------------------  
2023-12-15 20:49:12,419  |  INFO  |  INSERT SUCCESS record no 2   
2023-12-15 20:49:12,420  |  DEBUG  |  ---------------------------------  
2023-12-15 20:49:12,421  |  DEBUG  |  ---------------------------------  
2023-12-15 20:49:12,421  |  INFO  |  INSERT SUCCESS record no 3   
2023-12-15 20:49:12,421  |  DEBUG  |  ---------------------------------  
2023-12-15 20:49:12,422  |  DEBUG  |  ---------------------------------  
2023-12-15 20:49:12,423  |  INFO  |  INSERT SUCCESS record no 4   
2023-12-15 20:49:12,423  |  DEBUG  |  ---------------------------------  
2023-12-15 20:49:12,424  |  INFO  |  Rows after SQL insert in Postgres: 4   
2023-12-15 20:49:12,426  |  DEBUG  |    
2023-12-15 20:49:12,426  |  INFO  |  Sensitve columns: ['Product_Category']  
2023-12-15 20:49:12,442  |  INFO  |  ================================================  
2023-12-15 20:49:12,442  |  INFO  |  Total columns in table after insertion: 7  
2023-12-15 20:49:12,443  |  INFO  |  Columns name list in table after insertion: ['marketing_spend_id', 'date', 'offline_spend', 'online_spend', 'created_at', 'updated_at', 'source']  
2023-12-15 20:49:12,443  |  DEBUG  |    
2023-12-15 20:49:12,444  |  INFO  |  DATA VALIDATION SUCCESS: All general DQ checks passed!   
2023-12-15 20:49:12,444  |  DEBUG  |    
2023-12-15 20:49:12,444  |  INFO  |  Now saving changes made by SQL statements to Postgres DB....  
2023-12-15 20:49:12,444  |  INFO  |  Saved successfully, now terminating cursor and current session....  
2023-12-15 20:49:12,445  |  DEBUG  |    
2023-12-15 20:49:12,445  |  DEBUG  |  Cursor closed successfully.  
2023-12-15 20:49:12,446  |  DEBUG  |  Session connected to Postgres database closed.  
